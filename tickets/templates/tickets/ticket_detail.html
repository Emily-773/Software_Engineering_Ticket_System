{% extends "tickets/base.html" %}

{% block title %}Ticket #{{ ticket.id }}{% endblock %}

{% block content %}
<div class="d-flex align-items-start justify-content-between flex-wrap gap-2 mb-3">
  <div>
    <h1 class="h4 mb-1">Ticket #{{ ticket.id }} â€” {{ ticket.title }}</h1>
    <div class="text-muted">Created: {{ ticket.created_at }}</div>
  </div>

  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{% url 'ticket_list' %}">Back to Tickets</a>

    {% if is_admin %}
      {% if ticket.status == "New" or ticket.status == "Open" %}
        <a class="btn btn-warning" href="{% url 'ticket_assign' ticket.id %}">
          Assign / Reassign Technician
        </a>
      {% endif %}
    {% endif %}
  </div>
</div>

<div class="row g-3">
  <div class="col-12 col-lg-8">
    <div class="card shadow-sm">
      <div class="card-header">
        <h2 class="h6 mb-0">Description</h2>
      </div>
      <div class="card-body">
        <p class="mb-0">{{ ticket.description }}</p>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-4">
    <div class="card shadow-sm">
      <div class="card-header">
        <h2 class="h6 mb-0">Details</h2>
      </div>
      <div class="card-body">
        <dl class="row mb-0">
          <dt class="col-5">Status</dt>
          <dd class="col-7">
            <span class="badge bg-info text-dark">{{ ticket.status }}</span>
          </dd>

          <dt class="col-5">Reporter</dt>
          <dd class="col-7">{{ ticket.reporter.username }}</dd>

          <dt class="col-5">Assignee</dt>
          <dd class="col-7">{{ ticket.assignee.username|default:"Unassigned" }}</dd>

          <dt class="col-5">Category</dt>
          <dd class="col-7">{{ ticket.category.name }}</dd>

          <dt class="col-5">Priority</dt>
          <dd class="col-7">{{ ticket.priority.name }}</dd>
        </dl>
      </div>
    </div>
  </div>
</div>
{% endblock %}